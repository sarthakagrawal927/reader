@import 'tailwindcss';
@plugin "@tailwindcss/typography";

:root {
  --background: #0a0a0a;
  --foreground: #ededed;
}

@media (prefers-color-scheme: light) {
  :root {
    --background: #ffffff;
    --foreground: #171717;
  }
}

body {
  background: var(--background);
  color: var(--foreground);
  font-family: Arial, Helvetica, sans-serif;
}

/* Custom Typography Styles */
@layer base {
  /* Footnotes */
  sup {
    @apply text-blue-500 font-bold ml-0.5 cursor-pointer hover:underline;
    font-size: 0.75em;
    vertical-align: super;
  }

  /* Lists */
  .prose ul > li {
    @apply my-2 pl-2 marker:text-gray-500;
  }
  .prose ol > li {
    @apply my-2 pl-2 marker:text-gray-500;
  }

  /* Blockquotes */
  .prose blockquote {
    @apply relative border-l-4 border-blue-500 bg-gray-800/50 py-6 px-8 italic rounded-r-xl text-gray-300 shadow-md my-8;
  }

  .prose blockquote::before {
    content: '"';
    @apply absolute top-2 left-4 text-4xl text-blue-500/20 font-serif pointer-events-none;
  }

  /* Images */
  .prose img {
    @apply rounded-xl shadow-lg my-8 mx-auto;
  }

  /* Links */
  .prose a {
    @apply text-blue-600 no-underline hover:underline transition-colors;
  }

  /* Code Blocks */
  .prose pre {
    @apply bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-100 rounded-lg p-4 overflow-x-auto border border-gray-200 dark:border-gray-700;
  }

  .prose code {
    @apply bg-gray-100 dark:bg-gray-800 text-pink-600 dark:text-pink-400 px-1 py-0.5 rounded font-mono text-sm;
  }

  .prose pre code {
    @apply bg-transparent text-inherit p-0 border-none;
  }

  /* Sepia Mode Overrides */
  .prose-amber pre {
    @apply bg-[#e3dccb] border-[#d4cbb0] text-[#5b4636];
  }

  .prose-amber code {
    @apply bg-[#e3dccb] text-[#5b4636];
  }
}

/* React Flow Dark Theme */
.board-canvas .react-flow__pane {
  cursor: grab;
}
.board-canvas .react-flow__pane:active {
  cursor: grabbing;
}
.board-canvas .react-flow__node {
  cursor: pointer;
}
.board-canvas .react-flow__node.selected {
  z-index: 10 !important;
}
.board-canvas .react-flow__edge-path {
  stroke: #4b5563;
}
.board-canvas .react-flow__edge.selected .react-flow__edge-path {
  stroke: #3b82f6;
}
.board-canvas .react-flow__connection-path {
  stroke: #6b7280;
  stroke-dasharray: 5 5;
}
.board-canvas .react-flow__handle {
  opacity: 0;
  transition: opacity 150ms;
}
.board-canvas .react-flow__node:hover .react-flow__handle,
.board-canvas .react-flow__node.selected .react-flow__handle {
  opacity: 1;
}

.annotation-target {
  position: relative;
}

.annotation-host {
  position: relative;
}

.annotation-marker-group {
  display: inline-flex;
  gap: 0.35rem;
  align-items: center;
  margin-left: 0.35rem;
  margin-right: 0;
  position: relative;
  top: 0;
  vertical-align: middle;
  z-index: 30;
}

.annotation-marker-group-media {
  position: absolute;
  top: 0.5rem;
  left: 0.5rem;
  margin-left: 0;
  gap: 0.25rem;
  flex-direction: column;
}

.annotation-marker {
  width: 1.75rem;
  height: 1.75rem;
  border-radius: 9999px;
  background: #f59e0b;
  color: #78350f;
  font-weight: 700;
  font-size: 0.75rem;
  border: 2px solid #111827;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.35);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition:
    transform 120ms ease,
    box-shadow 120ms ease,
    opacity 120ms ease;
  position: relative;
  z-index: 40;
  vertical-align: middle;
}

.annotation-drag-ghost {
  position: fixed;
  width: 2rem;
  height: 2rem;
  border-radius: 9999px;
  background: #fbbf24;
  color: #78350f;
  border: 2px solid #111827;
  box-shadow: 0 8px 18px rgba(0, 0, 0, 0.45);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 800;
  font-size: 0.9rem;
  pointer-events: none;
  transform: translate(-50%, -50%);
  z-index: 999;
}

.annotation-tooltip-floating {
  position: fixed;
  transform: translate(-50%, -110%);
  background: #0b1220;
  color: #f3f4f6;
  border: 1px solid #1f2937;
  border-radius: 0.5rem;
  padding: 0.35rem 0.6rem;
  white-space: nowrap;
  font-size: 0.78rem;
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.35);
  pointer-events: none;
  z-index: 1200;
  max-width: 18rem;
  overflow: hidden;
  text-overflow: ellipsis;
}

.annotation-marker:hover {
  transform: scale(1.08);
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.45);
}

.annotation-marker:active {
  transform: scale(0.95);
}
